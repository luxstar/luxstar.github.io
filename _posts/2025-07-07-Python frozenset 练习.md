---
title: Python frozenset 练习
date: 2025-07-08 15:53:00 +0800
categories: [Python]
tags: [Python,frozenset]
---
好的，我们来系统性地讲解 Python 中的 `frozenset`：

---

## 💡 问题：什么是 Python `frozenset`？

### 一、为什么会出现这个问题？

在 Python 中，`set` 是一种内置的**可变集合**，但在某些情况下我们需要一个**不可变的集合**，比如：

* 用作字典的键（`set` 不可哈希）
* 作为其他集合的元素（因为 `set` 本身不能嵌套）
* 用于多线程或并发场景下需要只读集合
* 保证集合不被意外修改

为了解决这些问题，Python 提供了 **`frozenset`**，这是一个**不可变的集合类型**。

---

### 二、什么样的场景下会出现这样的问题？

1. **需要将集合用作字典键**：

   ```python
   s = set([1, 2, 3])
   d = {s: 'value'}  # TypeError: unhashable type: 'set'
   ```

2. **将集合作为另一个集合的元素**：

   ```python
   s1 = set([1, 2])
   s2 = set([s1])  # TypeError: unhashable type: 'set'
   ```

3. **用于缓存、查重、集合运算中，需要集合不可变性来确保安全**。

---

### 三、出现这种问题要如何处理？

#### 使用 `frozenset` 解决

```python
s = frozenset([1, 2, 3])
d = {s: 'value'}  # ✅ 可以作为字典键
```

#### `frozenset` 的性质

* 不可变（不能 `.add()`、`.remove()`）
* 可哈希
* 支持集合运算：`&`, `|`, `-`, `^`

---

### 四、该问题的最佳实践是什么？

1. **用 `frozenset` 来构建稳定、可哈希的集合结构**。
2. **不要修改 frozenset 的数据**，因为它是只读的。
3. **在设计不可变数据结构（例如作为缓存键、哈希表结构）时优先考虑使用 `frozenset`**。
4. **如果集合数据确定不会改变，用 `frozenset` 替代 `set` 更安全**。

---

## 📘 小结对比：`set` vs `frozenset`

| 特性     | `set`     | `frozenset` |
| ------ | --------- | ----------- |
| 可变性    | ✅ 可变      | ❌ 不可变       |
| 可哈希性   | ❌ 不可哈希    | ✅ 可哈希       |
| 可作为字典键 | ❌ 不可以     | ✅ 可以        |
| 方法支持   | 添加/删除/清空等 | 只有集合运算相关方法  |

---

## 🧠 练习题（由浅入深）

### 🌱 初级

1. 创建一个 `frozenset` 包含数字 1 到 5。
2. 尝试对 `frozenset` 使用 `.add()` 方法，观察会发生什么。
3. 将两个 `frozenset` 做交集运算。

### 🌿 中级

4. 将列表 `[[1,2], [3,4], [1,2]]` 中的子元素转成 `frozenset`，并去重。
5. 使用 `frozenset` 作为字典的键，实现：`{frozenset([1, 2]): 'a', frozenset([3]): 'b'}`。
6. 判断两个 `frozenset` 是否相等。

### 🌳 高级

7. 构造一个函数，接受一组列表，返回所有唯一的子集合（用 `frozenset` 表示）。
8. 你设计一个不可变缓存系统，缓存键是多个条件组合，如何使用 `frozenset` 实现？

---

如需我为这些题目提供参考答案或进一步扩展难度，随时告诉我。你也可以将某道题做完贴上来，我来帮你检查。
